language: java
jdk:
  - oraclejdk8
os:
  - linux
cache:
  directories:
    - ~/.m2/repository
#install:
#  - mvn clean install -DskipTests=true -Dmaven.javadoc.skip=true
#  - mvn test sonar:sonar -Dmaven.javadoc.skip=true -Dsonar.projectKey=${sonar_project_key} -Dsonar.organization=${sonar_organization} -Dsonar.host.url=${sonar_host_url} -Dsonar.login=${sonar_token}
#  - mvn clean install site --settings config/travis/mvn-settings.xml
jobs:
  include:
    - stage: "Build & Test"
      name: "Build"
      install: mvn clean install -DskipTests=true -Dmaven.javadoc.skip=true
    - stage: "Test"
      name: "Test"
      install: mvn test -Dmaven.javadoc.skip=true
    - stage: "Quality Check"
      if: branch = master
      name: "Sonar check"
      install: mvn test sonar:sonar -Dmaven.javadoc.skip=true -Dsonar.projectKey=${sonar_project_key} -Dsonar.organization=${sonar_organization} -Dsonar.host.url=${sonar_host_url} -Dsonar.login=${sonar_token}
    - stage: "Site Build"
      name: "GitHub Site Build and Publish"
      install: mvn clean install site --settings config/travis/mvn-settings.xml -DskipTests=true
#    - stage: "Deploy"
#      if: branch = master
#      name: "Deploy"
#      install: mvn test sonar:sonar -Dmaven.javadoc.skip=true -Dsonar.projectKey=${sonar_project_key} -Dsonar.organization=${sonar_organization} -Dsonar.host.url=${sonar_host_url} -Dsonar.login=${sonar_token}
