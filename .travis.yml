language: java
os:
  - linux
cache:
  directories:
    - ~/.m2/repository
jobs:
  include:
#    - stage: "Build"
#      name: "Build and Test"
#      jdk: oraclejdk11
#      install: mvn clean install -Dmaven.javadoc.skip=true -B
#    - stage: "Quality Check"
#    name: "Sonar check"
#    if: branch = master
#      jdk: oraclejdk11
#      install: mvn test -B sonar:sonar -Dmaven.javadoc.skip=true -Dsonar.projectKey=${sonar_project_key} -Dsonar.organization=${sonar_organization} -Dsonar.host.url=${sonar_host_url} -Dsonar.login=${sonar_token}
#    - stage: "Site Build and Publish"
#    name: "Site build and publish on GitHub pages"
#    if: branch = master
#      jdk: oraclejdk8
#      install: mvn clean site:site -DskipTests=true -B
#      deploy:
#        provider: pages
#        local-dir: target/site
#        skip-cleanup: true
#        github-token: ${github_oauth_token}
#        keep-history: true
#        on:
#          branch: feature/travis-configuration
    - stage: "Release"
      name: "Releasing artifacts on Maven central"
      #      if: branch = master
      jdk: oraclejdk8
      script: mvn versions:set -DnewVersion=${TRAVIS_TAG} && mvn clean deploy -DforceTags -DpushImageTag -B -U -P -DskipTests=true release --settings config/travis/mvn-settings.xml
      on:
        tags: true
#    - stage: "Release"
#      name: "Releasing artifacts on Maven central"
#      "https://blog.travis-ci.com/2017-03-30-deploy-maven-travis-ci-packagecloud/"
#deploy:
#  provider: script
#    script: "mvn versions:set -DnewVersion=${TRAVIS_TAG} && mvn clean deploy -B -U -P release --settings travis/settings.xml"
#    on:
#      tags: true